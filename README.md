# Руководство по Использованию

Это руководство поможет вам быстро запустить и протестировать систему биометрического анализа на основе YOLOv8-pose и гомографии.

## Быстрый Старт (Стандартный Тест)

Для запуска стандартного тестового примера (использующего файл `video.webm` из папки `data` и предопределенные настройки гомографии) выполните следующие шаги.

### 1\. Запуск Сервера (API)

Сервер `main.py` отвечает за обработку кадров, выполнение нейронной сети, расчет биометрических признаков и аудит аномалий.

```bash
# Убедитесь, что вы находитесь в корневой папке проекта и активировали виртуальное окружение.
python main.py
```

Сервер запустится по адресу `http://0.0.0.0:8000`.

### 2\. Запуск Клиента (Тест Видео)

Клиент `video_test.py` читает видеофайл, отправляет кадры на API-сервер и отображает результаты в реальном времени.

```bash
python video_test.py
```

После запуска клиент начнет отображать окно с видео, на котором будут видны результаты трекинга, расчеты и аномалии.

> **Примечание:** Для успешной работы системе необходимо несколько секунд (зависит от настройки `SKIP_FRAMES` и `REFERENCE_HEIGHT_CM` в `config_opt.py`), чтобы выполнить **авто-калибровку** (определить соотношение пикселей к сантиметрам). До завершения калибровки результаты могут быть неточными.

-----

## Запуск на Собственном Примере (Кастомный Тест)

Если вы хотите протестировать систему с собственным видеофайлом или изображением, необходимо выполнить подготовительные шаги, особенно связанные с **Гомографией**.

### Шаг 1: Подготовка Файлов

1.  **Поместите медиафайл** (видео или изображение) в папку `data/`.
2.  **Обновите путь к файлу** в клиентском скрипте (`video_test.py`) и скрипте калибровки (`homography.py`), если имя файла отличается от стандартного (`video.webm` и `image.png` соответственно).

### Шаг 2: Расчет Матрицы Гомографии (Обязательно, если `HOMOGRAPHY_ENABLED = True`)

Гомография необходима для "выпрямления" перспективы, что позволяет проводить точные метрические измерения (рост, скорость, пропорции).

1.  **Откройте `homography.py`** и убедитесь, что:

      * `TEST_FRAME_NAME` указывает на **тестовое изображение** из вашего видео (рекомендуется).
      * `TARGET_SIZE` соответствует настройке в `config_opt.py`.

2.  **Запустите скрипт калибровки:**

    ```bash
    python homography.py
    ```

3.  **Выберите 4 Точки:** Следуйте инструкции в консоли, чтобы выбрать 4 точки на вашем исходном кадре. **Порядок строгий:**

    1.  Верхний Левый Угол
    2.  Верхний Правый Угол
    3.  Нижний Правый Угол
    4.  Нижний Левый Угол

4.  После выбора 4 точек, нажмите **ENTER**. Скрипт рассчитает матрицу гомографии `H` и сохранит ее в файл (`models/H_cam_01.json`).

### Шаг 3: Запуск Сервера и Клиента

После сохранения матрицы гомографии, запуск системы аналогичен Быстрому Старту:

1.  Запустите сервер: `python main.py`
2.  Запустите клиент: `python video_test.py`

-----

## Отключение Гомографии

Если вы не хотите использовать гомографию или не можете ее правильно рассчитать (например, если камера установлена перпендикулярно плоскости пола), вы можете отключить её в конфигурации.

1.  **Откройте `config_opt.py`**.

2.  **Установите флаг:**

    ```python
    HOMOGRAPHY_ENABLED: bool = False
    ```

3.  **Запустите систему:**

      * `python main.py`
      * `python video_test.py`

> **Внимание:** Без гомографии метрические расчеты (рост, скорость) могут быть **неточными**, особенно вдали от камеры. Система будет полагаться только на авто-калибровку по высоте, используя `REFERENCE_HEIGHT_CM`.